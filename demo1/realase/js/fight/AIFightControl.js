var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),AIFightControl=function(r){function e(){var e=r.call(this)||this;return e.chracterEnemyArr=[],e.characterPlayerArr=[],e.curFightRound=0,e.curEnemyIndex=0,e.curPlayerIndex=0,e}return __extends(e,r),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.startup=function(){this.curFightRound=0,this.curEnemyIndex=0,this.curPlayerIndex=0,this.chracterEnemyArr=[],this.characterPlayerArr=[];for(var r=0,e=SceneManager.instance.fightCharacterEnemyArr;r<e.length;r++){var t=e[r];this.chracterEnemyArr.push(t.fightPoint)}for(var n=0,a=SceneManager.instance.fightCharacterPlayerArr;n<a.length;n++){var h=a[n];this.characterPlayerArr.push(h.fightPoint)}Laya.timer.once(2e3,this,this._beginFight)},e.prototype.nextFightRound=function(){0==this.characterPlayerArr.length||0==this.chracterEnemyArr.length?this._fightEnd():this._beginFight()},e.prototype.removeDieCharacter=function(r,e){var t;r==CampType.Enemy?(t=this.chracterEnemyArr.indexOf(e),this.chracterEnemyArr.splice(t,1)):r==CampType.Player&&(t=this.characterPlayerArr.indexOf(e),this.characterPlayerArr.splice(t,1))},e.prototype._beginFight=function(){this.curFightRound++;var r,e,t,n,a,h=Math.random(),c=[];if(this.curFightRound%2!=0){if(this.curPlayerIndex=this.curPlayerIndex>=this.characterPlayerArr.length?0:this.curPlayerIndex,e=this.characterPlayerArr[this.curPlayerIndex],n=SceneManager.instance.fightCharacterPlayerArr[e],h>.5){if(this.chracterEnemyArr.length<=3)for(i=0;i<this.chracterEnemyArr.length;i++)t=this.chracterEnemyArr[i],a=SceneManager.instance.fightCharacterEnemyArr[t],c.push(a);else for(i=0;i<3;i++)t=this.chracterEnemyArr[i],a=SceneManager.instance.fightCharacterEnemyArr[t],c.push(a);n.skillAttack(c)}else r=Math.floor(Math.random()*this.chracterEnemyArr.length),t=this.chracterEnemyArr[r],a=SceneManager.instance.fightCharacterEnemyArr[t],n.normalAttack(a);this.curPlayerIndex++}else{if(this.curEnemyIndex=this.curEnemyIndex>=this.chracterEnemyArr.length?0:this.curEnemyIndex,t=this.chracterEnemyArr[this.curEnemyIndex],a=SceneManager.instance.fightCharacterEnemyArr[t],h>.5){if(this.characterPlayerArr.length<=3)for(i=0;i<this.characterPlayerArr.length;i++)e=this.characterPlayerArr[i],n=SceneManager.instance.fightCharacterPlayerArr[e],c.push(n);else for(var i=0;i<3;i++)e=this.characterPlayerArr[i],n=SceneManager.instance.fightCharacterPlayerArr[e],c.push(n);a.skillAttack(c)}else r=Math.floor(Math.random()*this.characterPlayerArr.length),e=this.characterPlayerArr[r],n=SceneManager.instance.fightCharacterPlayerArr[e],a.normalAttack(n);this.curEnemyIndex++}},e.prototype._fightEnd=function(){SceneManager.instance.exitFight(),this.event("fightEnd")},e}(Laya.EventDispatcher);