var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),Part=function(t){function e(){var e=t.call(this)||this;return e.totalFrames=0,e.dep=0,e.act="",e.val="",e._curFrm=-1,e._perc=0,e.type=2,e.aniIsLoad=!1,e.aniInterv=300,e.repeat=!0,e.endTime=Number.MAX_VALUE,e.frameRate=30,e}return __extends(e,t),e.create=function(){return e.POOL.length?e.POOL.pop():new e},e.prototype.setVal=function(t){if(t!=this.val){if(this.res){var e=this.res.useParts.indexOf(this);this.res.useParts.splice(e,1),RESManager.instance.reduceRes(this.val),this.mcdata=null}this.val=t,t?(this.res=RESManager.instance.refRes(t),this.res&&(this.res.useParts.push(this),this.buildmc())):(this.res=null,this.texture=null)}},e.prototype.render=function(e,i,s){this.updatePec(),t.prototype.render.call(this,e,i,s)},e.prototype.setAct=function(t){t&&this.act!=t&&(this.act=t,this.buildmc())},e.prototype.setPec=function(t){this.visible&&this.displayedInStage&&(this._perc=t)},e.prototype.updatePec=function(){if(this.mcdata&&this.res&&this.res.factory){var t=this.mcdata,e=t.numFrames,i=this._perc*e>>0;if(i>=e&&this.event(Laya.Event.COMPLETE),i>=e&&(i-=1),this._curFrm!=i){var s=t.frames[i];if(this._curFrm=i,s){if(t.spriteSheet){var r=t.spriteSheet._textureMap[s.res];if(!r){var a=t.textureData[s.res];r=t.spriteSheet.createTexture(s.res,a.x,a.y,a.w,a.h)}this.graphics.clear(),this.graphics.drawTexture(r)}this.pivotX!=-s.x&&(this.pivotX=-s.x),this.pivotY!=-s.y&&(this.pivotY=-s.y)}}}},e.prototype.destroy=function(){t.prototype.destroy.call(this)},e.prototype.buildmc=function(){this.res&&this.res.factory&&(this.mcdata=this.res.factory.generateMovieClipData(this.act),this.mcdata&&(this.frameRate=this.mcdata.frameRate),this._curFrm=-1,this.aniInterv=100/3*this.frameRate,0==this.repeat&&(this.endTime=this.startTime+this.aniInterv),this.setPec(this._perc))},e.prototype.dispose=function(){this.destroyed||(this.removeSelf(),this.reset(),e.POOL.push(this))},e.prototype.reset=function(){this.alpha=1,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,this.rotation=0,this.visible=!0,this.mcdata=null,this.setVal(null),this.graphics.clear(),this._perc=0,this._curFrm=-1,this.dep=0,this.aniIsLoad=!1,this.aniInterv=300,this.repeat=!0,this.endTime=Number.MAX_VALUE,this.frameRate=30},e.POOL=[],e}(Laya.Sprite);